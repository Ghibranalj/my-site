name: publishing github pages

on:
  push:
    branches:
      - master

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
        - uses: actions/checkout@v2
          name: Check out repository

        - name: Setup emsdk
          uses: mymindstorm/setup-emsdk@v11
          with:
            version: 3.1.9
            actions-cache-folder: 'emsdk-cache'

        - name: Verify
          run: emcc -v
        
        - name : Building for release
          run : make release

        - name : commit files
          run : |
            git config --local user.email "41898282+github-actions[bot]@users.noreply.github.com"
            git config --local user.name "github-actions[bot]"
            git add docs/ --force
            git commit -m "Github Actions auto-deploy" -a

        - name: Push changes
          uses: ad-m/github-push-action@master
          with:
            github_token: ${{ secrets.GIT_GITHUB_TOKEN }}
            branch: "github-pages"
        
